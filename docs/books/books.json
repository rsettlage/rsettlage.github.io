[
  {
    "path": "books/2022-07-02-hobbs-hooten-ch1/",
    "title": "Hobbs-Hooten Chapter 1",
    "description": "A quick summary of Hobbs and Hooten's Bayesian Models, Chapter 1.",
    "author": [
      {
        "name": "Robert Settlage",
        "url": {}
      }
    ],
    "date": "2022-07-02",
    "categories": [
      "Bayesian modeling",
      "Bayesian networks"
    ],
    "contents": "\n\nContents\nChapter 1\nProcess models\nSampling models\nObservation models\nParameter models\nFull model\n\nExample\nWildebeast population as a function of rainfall\nProcess model\nSampling model\nObservation model\nFull model\n\n\nI absolutely love this book. It is approachable and thorough. I am in\nmy second work through of the book and will just give the most brief\nnotes here. Besides the parallels between Picaso and Box, my favorite\nline in the book is “your science will have impact to the extent that\nyou are able to ask important questions and provide compelling answers\nto them”. I have always thought you should ask first the question you\nwant answered, then think about how you should go about gathering data\nto answer it. That hones the study to something achievable. In my write\nup, there are definitely phrases stolen, so consider this entire write\nup referenced.\nHobbs Hooten@book{10.2307/j.ctt1dr36kz,\nURL = {http://www.jstor.org/stable/j.ctt1dr36kz},\nabstract = {This textbook provides a comprehensive and accessible\nintroduction to the latest Bayesian methods-in language ecologists can\nunderstand.},\nauthor = {N. Thompson Hobbs and Mevin B. Hooten},\nedition = {STU - Student edition},\npublisher = {Princeton University Press},\ntitle = {Bayesian Models: A Statistical Primer for Ecologists},\nurldate = {2022-07-02},\nyear = {2015}\n}\nChapter 1\nThis is really setting the stage for the whole book. The main idea is\nthat an analysis of data tracks uncertainty through mathmatical modeling\nof the phenomena being observed to gain insight into the system. They\nbreak the process 4 main steps (stated in preface):\nDesign\nHere existing theory, scientific objectives and intuition combine to\nhelp write a deterministic model of the process\nModel Specification\nDiagram the relationship(s) between observed and unobserved quantities,\nuse these relationships to write out the posterior using general\nprobability notation, and finally choose the appropriate probability\ndistributions for the quantities\nModel implementation\nWrite full-conditional distribusions, write MCMC sampling algorithm,\ntest MCMC on simulated data, run MCMC algorithm on real data\nModel evaluation and inference\nPosterior predictive checks include probablistic inference from a single\nmodel and/or model selection and model averaging.\nHobbs and Hooten sketch out the framework for modelling as creating a\nseries of submodels that are chained to gether, Bayesian style. These\nmodels include: process models, sampling models, observational models,\nand parameter models.\nProcess models\nProcess models are mathematical statemensts that depict a process and\nour uncertainty about that process. Here we start by thinking about a\ntrue state (\\(z\\)) and are looking to\nunderstand influencers of the state, ie the things that make it change.\nTo the modeler, this will be a combination of a deterministic statement\nwith realizations of uncertainty. The deterministic part relates what we\nknow or can measure to our understanding of the system. We add\nuncertainty because we know we have omitted in our simplifications.\n\\[\n\\begin{equation}\n\\tag{1}\n\\left [ z \\mid g(\\theta_p, \\mathbf{x}), \\sigma_p^2 \\right ]\n\\end{equation}\n\\]\nSampling models\nFirst, we realize that in most studies, we can not observe all\ninstances of the true state of the system so we need to take samples\nfrom the system. The authors use \\(u_i\\) where \\(i =\n1 \\dots n\\) denote the observations taken.\n\\[\n\\begin{equation}\n\\tag{2}\n\\left [ u_i \\mid z, \\sigma_s^2 \\right ]\n\\end{equation}\n\\]\nObservation models\nThere is often a mismatch between what we observe and the true state,\nkinda a bias. The authors call this an observation model, I would call\nit a measurement model. Note that if we can observe perfectly samples\nfrom the true state, \\(y_i = u_i\\), ie\nwe do not need an observational model and our sampling model (and\nassociated sampling uncertainty) are enough to describe our\nobservations.\nParameter models\nWe have include parameters in our models that require some sort of\nunderstanding. We represent the parameters using probability\ndistributions. Ideally, we would have some prior knowledge of these\nparameters.\n\\[\n\\begin{equation}\n\\tag{3}\n\\left [ y_i \\mid d(\\theta_o, u_i), \\sigma_o^2 \\right ]\n\\end{equation}\n\\]\n\\[\n\\begin{equation}\n\\tag{4}\n\\left [ \\theta_p \\right ] \\left [ \\theta_o \\right ] \\left [ \\sigma_p^2\n\\right ] \\left [ \\sigma_s^2 \\right ] \\left [ \\sigma_o^2 \\right ]\n\\end{equation}\n\\]\nFull model\nPutting it all together, we can write down the posterior as:\n\\[\n\\begin{equation}\n\\tag{5}\n\\left [ {\\underbrace { z, \\theta_p, \\theta_o, \\sigma_p^2, \\sigma_s^2,\n\\sigma_o^2, u_i }_{\\text{unobserved}}} \\mid {\\underbrace { y_i\n}_{\\text{observed}}} \\right ] \\propto \\left [ {\\underbrace { y_i \\mid\nd(\\theta_o, u_i), \\sigma_o^2}_{\\text{observation model}}} \\right ] \\left\n[ {\\underbrace { u_i \\mid z, \\sigma_s^2}_{\\text{sampling model}}} \\right\n] \\ast  \\\\ \\left [ {\\underbrace { z \\mid g(\\theta_p, \\mathbf{x}),\n\\sigma_p^2}_{\\text{process model}}} \\right ]  {\\underbrace { \\left [\n\\theta_p \\right ] \\left [ \\theta_o \\right ] \\left [ \\sigma_p^2 \\right ]\n\\left [ \\sigma_s^2 \\right ] \\left [ \\sigma_o^2 \\right ]\n}_{\\text{parameter models}}}\n\\end{equation}\n\\]\nExample\nWildebeast population as a function of rainfall\nThe example is informative in that it is completely worked as they\nwill want in the exersizes, so I am going to summarize. First, what is\nthe system and question: wildebeest population in the grasslands of\nTanzania and Kenya appear to be in a steady state caused by\ninstraspecific competition for green plant biomass during the dry\nseeason which in turn is approximately proportional to the annually\nvariable rainfall. That’s a lot to digest, however, the specific\nquestion helps narrow our focus: how does variation in weather modify\nfeedbacks between population density and population growth rate in a\npopulation of wildebeest where precipitation is variable in time. From\nabove, the modeler needs to specify the parts to the model:\n\\[prior \\propto \\text{observation model}\n\\ast \\text{sampling model} \\ast \\text{process model} \\ast\n\\text{parameters model}\\]\nProcess model\nThe question suggests we are looking to model the unobserved true\nnumber of wildebeest in year t. Rather than use \\(z\\), we will use \\(N_t\\) as is customary for population\ncounts. We do have explanatory variables, namely annual rainfall in year\nt, denoted as \\(x_t\\). Hobbs and Hooten\ngive the following for the process model:\n\\[\n\\begin{equation}\n\\tag{6}\nN_t = g(\\mathbf{\\beta},N_{t-1},x_t,\\Delta t) = N_{t-1}e^{(\\beta_0 +\n\\beta_1N_{t-1}+ \\beta_2 x_t + \\beta_3N_{t-1}x_t)\\Delta t}\n\\end{equation}\n\\]\nLooking at the parts, with zero rainfall and wildebeest, \\(e^{\\beta_0\\Delta t}\\) is the base change in\nabundance. The authors spend time discussing what it means to have zero\nrainfall and redefine \\(x_t\\) as the\ndeviation from the long term average rainfall in year t. With this\nreparameterization, \\(\\beta_1\\) is the\nchange in growth rate for each additional animal. The parameter \\(\\beta_2\\) gives the change in population\ngrowth rate due to a deviation from the long-term mean annual growth\nrate. This leaves \\(\\beta_3\\) as the\nmagnitude of rainfall on the population density. Equation (6) is steeped\nin population dynamic theory and is certainly something that would\nrequire some thought.\nEstimating the \\(\\beta\\)’s will\ndefinitely inform the question posed, however, a moments thought will\nlead one to a million parameters left out of the model: predation,\npaching and disease. To add the effects of these unknown and unspecified\nvariables in the model, we add a stochastic component and end at:\n\\[\n\\begin{equation}\n\\tag{7}\n\\left [ N_t \\mid g(\\underline{\\smash{\\beta}}, N_{t-1}, x_t, \\Delta t),\n\\sigma_p^2 \\right ]\n\\end{equation}\n\\]\nSampling model\nThe wildebeest population was estimated using spatially replicated\ncounts of animals on georectified aerial photographs covering some known\narea. A feature of the data is that the pictures did not cover the\nentire area. The data is assumed to represent a statistically\nindependent sample of the population density given as \\(\\frac{N-t}{a}\\) where \\(a\\) is the total area inhabited by the\nanimals.\n\\[\n\\begin{equation}\n\\tag{8}\n\\left [ y_{tj} \\mid \\frac{N_t}{a}, \\sigma_s^2 \\right ]\n\\end{equation}\n\\] Equation (7) gives us our observed density of animals at year\n\\(t\\) on photograph \\(j\\) across the entire habitat. Things\nomitted: bias in estimating animal density on a given picture,\nuncertainty is the counting itself, rainfall is measured without error,\netc which are all dealt with by including a stochastic component, \\(\\sigma_s^2\\).\nObservation model\nIn this case, we are considering our observation of animals to be\nperfect. The authors do provide a hypothetical case for using some sort\nof telemetry as a proxy for counting. They introduce the proxy as a\nprobability for being counted, \\(\\psi\\). Doing this gives the following:\n\\[\n\\begin{equation}\n\\tag{9}\n{\\underbrace {\\left [ y_i \\mid \\psi n_{tj}, \\sigma_o^2 \\right\n]}_{\\text{observation model}}}   {\\underbrace { \\left [ n_{tj} \\mid\n\\frac{N_t}{a}, \\sigma_s^2 \\right ]}_{\\text{sampling model}}}\n\\end{equation}\n\\] The sampling model includes \\(n_{tj}\\) as number of animals that are\ntruly present in picture \\(j\\) at time\n\\(t\\) and the observation model deals\nwith the under count through \\(\\psi\\)\nand associated uncertainty in estimating \\(\\psi\\) by inclusion of \\(\\sigma_o^2\\).\nFull model\nCombining the sampling model (8) with the process model (7) with\nmodels for the parameters, we get to the full model.\n\\[\n\\begin{equation}\n\\tag{9}\n\\left [ {\\underbrace\n{N_t,N_{t-1},\\underline{\\smash{\\beta}},\\sigma_p^2,\\sigma_s^2  }_{\\text{unobserved}}}  \\mid\n{\\underbrace { y_{tj}  }_{\\text{observed}}} \\right ] \\propto\n{\\underbrace {\\left [ y_{tj} \\mid \\frac{N_t}{a}, \\sigma_s^2 \\right\n]}_{\\text{sampling model}}}   {\\underbrace {\\left [ N_t \\mid\ng(\\underline{\\smash{\\beta}}, N_{t-1}, x_t, \\Delta t), \\sigma_p^2 \\right\n]}_{\\text{process model}}} {\\underbrace {\\left [ \\beta_0 \\right ] \\left\n[ \\beta_1 \\right ]\\left [ \\beta_2 \\right ] \\left [ \\beta_3 \\right ]\n\\left [ \\sigma_p^2 \\right ] \\left [ \\sigma_s^2 \\right\n]}_{\\text{parameter models}}}\n\\end{equation}\n\\] I am relatively new to Bayesian networks drawn as acyclic\ngraphs. I like the one they drew as it helps me focus on the different\nrelationships of parameters and quantities observed/calculated. Dashed\narrows are stochastic, solid indicate deterministic relationships with\nquantities observed without error.\n\n\n\nFigure 1: Bayesian network for Wildebeest example from Hobbs\nand Hooten.\n\n\n\nFrom this, we can see the data we need and the various parameters and\nwhere they are involved. If we had included a sampling model, there\nwould have been an additional layer to the figure with the associated\nparameters and dependencies drawn.\n\n\n\n",
    "preview": "books/2022-07-02-hobbs-hooten-ch1/./images/HH_fig1.2.1.png",
    "last_modified": "2022-07-03T08:39:27-04:00",
    "input_file": "hobbs-hooten-ch1.knit.md",
    "preview_width": 544,
    "preview_height": 244
  }
]
